<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/polymerfire/firebase-query.html">

<link rel="import" href="../../bower_components/paper-rating/paper-rating.html">
<link rel="import" href="../../bower_components/paper-ripple/paper-ripple.html">

<link rel="import" href="../../bower_components/iron-icon/iron-icon.html">
<link rel="import" href="../../bower_components/iron-icons/iron-icons.html">
<link rel="import" href="../../bower_components/iron-icons/communication-icons.html">
<link rel="import" href="../../bower_components/iron-image/iron-image.html">

<link rel="import" href="../shared-styles.html">

<dom-module id="plan-card">
  <template>
    <style include="shared-styles">
      .plan_card {
        background-color: white;
        position: relative;
        height: 100%;
        border-radius: 2px;
        overflow: hidden;
        @apply(--shadow-elevation-2dp);
        @apply(--shadow-transition);
        @apply(--plan-card);
        border-bottom: 2px solid var(--app-secondary-color);
      }
      .plan_card:hover {
        @apply(--shadow-elevation-6dp);
        @apply(--plan-card-hover);
      }
      .image {
        @apply(--plan-card-image);
      }
      .card_title {
        color: #444;
        line-height: 16px;
        font-size: 16px;
        @apply(--plan-card-title);
      }
      .description {
        font-size: 13px;
        color: var(--paper-grey-600);
        margin: 5px 0;
        @apply(--plan-card-description);
      }
      .location {
        font-size: 14px;
        vertical-align: middle;
        color: var(--paper-grey-600);
        margin-top: 8px;
        @apply(--plan-card-location);
      }
      .date_details {
        color: #888;
        margin-top: 5px;
      }
      .card_date {
        line-height: 19px;
        @apply(--plan-card-date);
      }
      .calendar_icon {
        margin-right: 5px;
        width: 18px;
        height: 18px;
        min-width: 18px;
        min-height: 18px;
      }
      .card_price {
        color: #aaa;
      }
      .card_content {
        padding: 16px;
        @apply(--plan-card-content);
      }
      .card_info {
        border-top: 1px solid #e8e8e8;
        padding: 16px;
        position: relative;
      }
      .schedule_icon {
        margin-right: 10px;
      }
      .hour {
        color: #9E9E9E;
      }
      .location_icon {
        margin-left: -3px;
        margin-right: 5px;
        min-width: 20px;
        min-height: 20px;
        width: 20px;
        height: 20px;
      }

      @media (max-width: 600px) {
        /* Info tarjeta */
        .card_content,
        .card_info {
          padding: 12px;
        }
        .description {
          font-size: 12px;
        }
        .location {
          font-size: 12px;
        }
        .location_icon,
        .calendar_icon {
          min-width: 16px;
          min-height: 16px;
          width: 16px;
          height: 16px;
        }
        .card_title {
          line-height: 14px;
          font-size: 14px;
        }
        .card_date {
          font-size: 12px;
        }
      }
    </style>

    <template is="dom-repeat" items="{{categories}}" as="categoryValue">
      <firebase-query
        app-name="mapetitecuisine"
        path="/categories"
        equal-to="{{categoryValue}}"
        data="{{categoryDetail}}" >
      </firebase-query>
    </template>

    <a href="{{url}}" class="link">
      <div class="plan_card">
        <iron-image class="image" src="{{image}}" preload fade sizing="cover"></iron-image>
        <div class="fix_overflow layout vertical">
          <div class="card_content">
            <div class="card_title overflow paper-font-body2">
              {{title}}
            </div>
            <div class="layout horizontal center">
              <template is="dom-if" if="{{date}}">
                <div class="date_details layout horizontal center">
                  <iron-icon class="calendar_icon" icon="event"></iron-icon>
                  <div class="card_date paper-font-body2">{{date}}</div>
                </div>
              </template>
              <paper-rating rating="{{rating}}" disabled></paper-rating>
              <!-- <span class="flex"></span>
              <div class="card_price paper-font-body2">{{_generatePriceRange(price)}}</div> -->
            </div>
            <div class="layout horizontal">
              <template is="dom-repeat" items="{{categoryDetail}}" as="category">
                <div class="chip_item chip_item_small noselect paper-font-caption">
                  <iron-icon icon="[[category.icon]]"></iron-icon>
                  <!-- [[category.name]] -->
                </div>
              </template>
            </div>
            <p class="description overflow">{{description}}</p>
            <!-- <template is="dom-if" if="{{location}}">
              <div class="location layout horizontal center">
                <iron-icon class="location_icon" icon="communication:location-on"></iron-icon>
                <span class="overflow">{{location}}</span>
              </div>
            </template> -->
          </div>
        </div>
        <paper-ripple></paper-ripple>
      </div>
    </a>

  </template>
  <script>
    Polymer({
      is: "plan-card",

      properties: {
        url:{
          type: String,
          reflectToAttribute: true
        },
        image:{
          type: String,
          reflectToAttribute: true
        },
        title:{
          type: String,
          reflectToAttribute: true
        },
        namentity:{
          type: String,
          reflectToAttribute: true
        },
        date:{
          type: String,
          reflectToAttribute: true
        },
        rating:{
          type: String,
          reflectToAttribute: true
        },
        price:{
          type: String,
          reflectToAttribute: true
        },
        description:{
          type: String,
          reflectToAttribute: true
        },
        categories:{
          type: Array,
          reflectToAttribute: true
        }
      }
      // _generatePriceRange: function (price) {
      //   var temp = "";
      //   for (var i = 0; i < price; i++) {
      //     temp = temp + "$";
      //   }
      //   return temp;
      // }
    })
  </script>
</dom-module>
